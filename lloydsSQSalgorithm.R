# Data:
LC.Global<-c("Achelousaurus","Agujaceratops","Agujaceratops","Agujaceratops","Agujaceratops","Agujaceratops","Alamosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Alaskacephale","Albertosaurus","Albertosaurus","Albertosaurus","Albertosaurus","Aletopelta","Ankylosaurus","Ankylosaurus","Anodontosaurus","Antarctopelta","Archaeornithoides","Aublysodon","Aublysodon","Aublysodon","Avaceratops","Bagaceratops","Bagaceratops","Bistahieversor","Bistahieversor","Bistahieversor","Bistahieversor","Brachylophosaurus","Caenagnathus","Caenagnathus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Coahuilaceratops","Coelosaurus","Coelosaurus","Coronosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Daspletosaurus","Daspletosaurus","Daspletosaurus","Daspletosaurus","Daspletosaurus","Deinodon","Deinodon","Deinodon","Deinodon","Deinodon","Deinodon","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dryptosaurus","Dyoplosaurus","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontosaurus","Edmontosaurus","Elsornis","Epichirostenotes","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euronychodon","Gobipteryx","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Hadrosaurus","Hagryphus","Hesperonychus","Hesperonychus","Hesperonychus","Hesperonychus","Hypacrosaurus","Hypacrosaurus","Hypsibema","Judiceratops","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Latirhinus","Leptorhynchos","Leptorhynchos","Leptorhynchos","Leptorhynchos","Lirainosaurus","Lirainosaurus","Lirainosaurus","Magnapaulia","Mahakala","Mojoceratops","Mojoceratops","Monoclonius","Monoclonius","Monoclonius","Monoclonius","Mononykus","Naashoibitosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodosaurus","Oohkotokia","Ornithomimus","Ornithomimus","Ornithomimus","Orodromeus","Orodromeus","Oviraptor","Oviraptor","Oviraptor","Pachycephalosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Palintropus","Panoplosaurus","Panoplosaurus","Panoplosaurus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pinacosaurus","Pinacosaurus","Pinacosaurus","Pinacosaurus","Pinacosaurus","Pinacosaurus","Pinacosaurus","Prenocephale","Prenocephale","Prenocephale","Prenocephale","Prenocephale","Prenoceratops","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Protoceratops","Protoceratops","Protoceratops","Protoceratops","Protoceratops","Protoceratops","Protoceratops","Protoceratops","Protoceratops","Protoceratops","Protoceratops","Protoceratops","Protoceratops","Rhabdodon","Rhabdodon","Rhabdodon","Rhabdodon","Rhabdodon","Saurolophus","Saurolophus","Saurornithoides","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Shuvuuia","Shuvuuia","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Struthiomimus","Struthiomimus","Struthiomimus","Struthiomimus","Struthiosaurus","Struthiosaurus","Struthiosaurus","Struthiosaurus","Stygimoloch","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Teratophoneus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Titanoceratops","Titanosaurus","Trachodon","Trinisaura","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Vagaceratops","Vagaceratops","Vagaceratops","Velafrons","Velociraptor","Velociraptor","Velociraptor","Velociraptor","Velociraptor","Velociraptor","Zalmoxes")
EM.Global<-c("Alamosaurus","Alamosaurus","Alamosaurus","Albertonykus","Albertosaurus","Albertosaurus","Atrociraptor","Austrocheirus","Daspletosaurus","Deinocheirus","Dromaeosaurus","Dromaeosaurus","Edmontonia","Edmontonia","Edmontosaurus","Edmontosaurus","Elbretornis","Elbretornis","Enantiornis","Enantiornis","Euoplocephalus","Euoplocephalus","Euoplocephalus","Gorgosaurus","Hypacrosaurus","Hypacrosaurus","Hypacrosaurus","Hypacrosaurus","Hypacrosaurus","Lectavis","Magyarosaurus","Martinavis","Martinavis","Martinavis","Martinavis","Martinavis","Montanoceratops","Montanoceratops","Montanoceratops","Noasaurus","Ojoceratops","Ojoceratops","Ojoraptorsaurus","Orkoraptor","Ornithomimus","Ornithomimus","Ornithomimus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Paludititan","Parksosaurus","Parksosaurus","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Puertasaurus","Rhabdodon","Rhabdodon","Rhabdodon","Rhabdodon","Rhabdodon","Saltasaurus","Saurolophus","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Soroavisaurus","Struthiosaurus","Talenkauen","Telmatosaurus","Telmatosaurus","Titanosaurus","Troodon","Troodon","Troodon","Troodon","Troodon","Wannanosaurus","Yungavolucris","Zalmoxes","Zalmoxes","Zalmoxes")
LM.Global<-c("Aeolosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Albertosaurus","Amurosaurus","Anatalavis","Anatotitan","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Arenysaurus","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Avisaurus","Avisaurus","Baurutitan","Blasisaurus","Brodavis","Bruhathkayosaurus","Ceramornis","Charonosaurus","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Deinodon","Deinodon","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dryptosaurus","Dryptosaurus","Dryptosaurus","Dryptosaurus","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Eotriceratops","Euronychodon","Euronychodon","Glyptodontopelta","Glyptodontopelta","Graculavus","Graculavus","Hadrosaurus","Hesperornis","Kerberosaurus","Kundurosaurus","Laornis","Leptoceratops","Leptoceratops","Leptoceratops","Lonchodytes","Magyarosaurus","Magyarosaurus","Mandschurosaurus","Nanotyrannus","Nanotyrannus","Olorotitan","Ornithomimus","Ornithomimus","Ornithomimus","Ornithomimus","Ornithomimus","Ornithomimus","Orthomerus","Orthomerus","Orthomerus","Pachycephalosaurus","Pachycephalosaurus","Pachycephalosaurus","Pachycephalosaurus","Palaeotringa","Panoplosaurus","Pararhabdodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Pentaceratops","Potamornis","Sahaliyania","Saurolophus","Saurolophus","Saurornithoides","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Struthiomimus","Struthiosaurus","Stygimoloch","Stygimoloch","Tarbosaurus","Tarbosaurus","Tarbosaurus","Tatankaceratops","Telmatornis","Telmatosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Titanosaurus","Torotix","Trachodon","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Trigonosaurus","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Uberabatitan","Vegavis","Volgavis","Wulagasaurus","Zalmoxes","Zalmoxes","Zalmoxes","Zalmoxes","Zalmoxes","Zalmoxes")
LC.NA.All<-c("Achelousaurus","Agujaceratops","Agujaceratops","Agujaceratops","Agujaceratops","Agujaceratops","Alamosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Alaskacephale","Albertosaurus","Albertosaurus","Albertosaurus","Albertosaurus","Aletopelta","Ankylosaurus","Ankylosaurus","Anodontosaurus","Aublysodon","Aublysodon","Aublysodon","Avaceratops","Bistahieversor","Bistahieversor","Bistahieversor","Bistahieversor","Brachylophosaurus","Caenagnathus","Caenagnathus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Coahuilaceratops","Coelosaurus","Coelosaurus","Coronosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Daspletosaurus","Daspletosaurus","Daspletosaurus","Daspletosaurus","Daspletosaurus","Deinodon","Deinodon","Deinodon","Deinodon","Deinodon","Deinodon","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dryptosaurus","Dyoplosaurus","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontosaurus","Edmontosaurus","Epichirostenotes","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Hadrosaurus","Hagryphus","Hesperonychus","Hesperonychus","Hesperonychus","Hesperonychus","Hypacrosaurus","Hypacrosaurus","Hypsibema","Judiceratops","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Latirhinus","Leptorhynchos","Leptorhynchos","Leptorhynchos","Leptorhynchos","Magnapaulia","Mojoceratops","Mojoceratops","Monoclonius","Monoclonius","Monoclonius","Monoclonius","Naashoibitosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodosaurus","Oohkotokia","Ornithomimus","Ornithomimus","Ornithomimus","Orodromeus","Orodromeus","Pachycephalosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Palintropus","Panoplosaurus","Panoplosaurus","Panoplosaurus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Prenocephale","Prenocephale","Prenocephale","Prenocephale","Prenocephale","Prenoceratops","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Saurolophus","Saurolophus","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Struthiomimus","Struthiomimus","Struthiomimus","Struthiomimus","Stygimoloch","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Teratophoneus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Titanoceratops","Trachodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Vagaceratops","Vagaceratops","Vagaceratops","Velafrons","Velociraptor")
EM.NA.All<-c("Alamosaurus","Alamosaurus","Alamosaurus","Albertonykus","Albertosaurus","Albertosaurus","Atrociraptor","Daspletosaurus","Dromaeosaurus","Dromaeosaurus","Edmontonia","Edmontonia","Edmontosaurus","Edmontosaurus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Gorgosaurus","Hypacrosaurus","Hypacrosaurus","Hypacrosaurus","Hypacrosaurus","Hypacrosaurus","Montanoceratops","Montanoceratops","Montanoceratops","Ojoceratops","Ojoceratops","Ojoraptorsaurus","Ornithomimus","Ornithomimus","Ornithomimus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Parksosaurus","Parksosaurus","Paronychodon","Paronychodon","Paronychodon","Saurolophus","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Troodon","Troodon","Troodon","Troodon","Troodon")
LM.NA.All<-c("Alamosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Alamosaurus","Albertosaurus","Anatalavis","Anatotitan","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Avisaurus","Avisaurus","Brodavis","Ceramornis","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Deinodon","Deinodon","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dryptosaurus","Dryptosaurus","Dryptosaurus","Dryptosaurus","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Eotriceratops","Glyptodontopelta","Glyptodontopelta","Graculavus","Graculavus","Hadrosaurus","Hesperornis","Laornis","Leptoceratops","Leptoceratops","Leptoceratops","Lonchodytes","Nanotyrannus","Nanotyrannus","Ornithomimus","Ornithomimus","Ornithomimus","Ornithomimus","Ornithomimus","Ornithomimus","Pachycephalosaurus","Pachycephalosaurus","Pachycephalosaurus","Pachycephalosaurus","Palaeotringa","Panoplosaurus","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Pentaceratops","Potamornis","Saurolophus","Saurolophus","Saurornithoides","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Struthiomimus","Stygimoloch","Stygimoloch","Tatankaceratops","Telmatornis","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Torotix","Trachodon","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus")
LC.NA.Ornithischia<-c("Achelousaurus","Agujaceratops","Agujaceratops","Agujaceratops","Agujaceratops","Agujaceratops","Alaskacephale","Aletopelta","Ankylosaurus","Ankylosaurus","Anodontosaurus","Avaceratops","Brachylophosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Centrosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Chasmosaurus","Coahuilaceratops","Coronosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Corythosaurus","Dyoplosaurus","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontosaurus","Edmontosaurus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Gryposaurus","Hadrosaurus","Hypacrosaurus","Hypacrosaurus","Hypsibema","Judiceratops","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Kritosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Lambeosaurus","Latirhinus","Magnapaulia","Mojoceratops","Mojoceratops","Monoclonius","Monoclonius","Monoclonius","Monoclonius","Naashoibitosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodocephalosaurus","Nodosaurus","Oohkotokia","Orodromeus","Orodromeus","Pachycephalosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Panoplosaurus","Panoplosaurus","Panoplosaurus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Parasaurolophus","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Pentaceratops","Prenocephale","Prenocephale","Prenocephale","Prenocephale","Prenocephale","Prenoceratops","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Prosaurolophus","Saurolophus","Saurolophus","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stegoceras","Stygimoloch","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Styracosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Titanoceratops","Trachodon","Vagaceratops","Vagaceratops","Vagaceratops","Velafrons")
EM.NA.Ornithischia<-c("Edmontonia","Edmontonia","Edmontosaurus","Edmontosaurus","Euoplocephalus","Euoplocephalus","Euoplocephalus","Hypacrosaurus","Hypacrosaurus","Hypacrosaurus","Hypacrosaurus","Hypacrosaurus","Montanoceratops","Montanoceratops","Montanoceratops","Ojoceratops","Ojoceratops","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Pachyrhinosaurus","Parksosaurus","Parksosaurus","Saurolophus")
LM.NA.Ornithischia<-c("Anatotitan","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Ankylosaurus","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontonia","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Edmontosaurus","Eotriceratops","Glyptodontopelta","Glyptodontopelta","Hadrosaurus","Leptoceratops","Leptoceratops","Leptoceratops","Pachycephalosaurus","Pachycephalosaurus","Pachycephalosaurus","Pachycephalosaurus","Panoplosaurus","Pentaceratops","Saurolophus","Saurolophus","Stygimoloch","Stygimoloch","Tatankaceratops","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Thescelosaurus","Trachodon","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops","Triceratops")
LC.NA.Theropoda<-c("Albertosaurus","Albertosaurus","Albertosaurus","Albertosaurus","Aublysodon","Aublysodon","Aublysodon","Bistahieversor","Bistahieversor","Bistahieversor","Bistahieversor","Caenagnathus","Caenagnathus","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Coelosaurus","Coelosaurus","Daspletosaurus","Daspletosaurus","Daspletosaurus","Daspletosaurus","Daspletosaurus","Deinodon","Deinodon","Deinodon","Deinodon","Deinodon","Deinodon","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dryptosaurus","Epichirostenotes","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Gorgosaurus","Hagryphus","Hesperonychus","Hesperonychus","Hesperonychus","Hesperonychus","Leptorhynchos","Leptorhynchos","Leptorhynchos","Leptorhynchos","Ornithomimus","Ornithomimus","Ornithomimus","Palintropus","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Struthiomimus","Struthiomimus","Struthiomimus","Struthiomimus","Teratophoneus","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Velociraptor")
EM.NA.Theropoda<-c("Albertonykus","Albertosaurus","Albertosaurus","Atrociraptor","Daspletosaurus","Dromaeosaurus","Dromaeosaurus","Gorgosaurus","Ojoraptorsaurus","Ornithomimus","Ornithomimus","Ornithomimus","Paronychodon","Paronychodon","Paronychodon","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Troodon","Troodon","Troodon","Troodon","Troodon")
LM.NA.Theropoda<-c("Albertosaurus","Anatalavis","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Aublysodon","Avisaurus","Avisaurus","Brodavis","Ceramornis","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Chirostenotes","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Cimolopteryx","Deinodon","Deinodon","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dromaeosaurus","Dryptosaurus","Dryptosaurus","Dryptosaurus","Dryptosaurus","Graculavus","Graculavus","Hesperornis","Laornis","Lonchodytes","Nanotyrannus","Nanotyrannus","Ornithomimus","Ornithomimus","Ornithomimus","Ornithomimus","Ornithomimus","Ornithomimus","Palaeotringa","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Paronychodon","Potamornis","Saurornithoides","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Saurornitholestes","Struthiomimus","Telmatornis","Torotix","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Troodon","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus","Tyrannosaurus")

# Function:
# sqs version 2.0 by John Alroy
# performs shareholder quorum subsampling on an array of specimen counts
# can be used to perform classical rarefaction instead of SQS
# written 29 July 2010; version 2.0 completed 14 February 2011
# changes in version 2.0: improved subsampling algorithm; including the dominant 
#  taxon is now the default; improved reporting of errors and basic statistics
# warning: do not use this program with taxonomic occurrence data drawn from
#  multiple published references because it is not designed to count
#  single-reference taxa or adjust for long taxonomic lists
# warning: version 1.0 yields estimates that are downwards-biased when q < 0.6
#  and abundance distributions are highly uneven
#
# Modified by GTL 22/03/11 to include single publication occurrence correction
sqs<-function(ab,q,trials,method,dominant,p.1)	{
  
  params <- array(data=NA,dim=0,dimnames=c("raw richness"))
  if (missing(trials))	{
    trials <- 100
  }
  if (missing(method))	{
    method <- ""
  } else if (method != "" && method != "rarefaction" && method != "CR")	{
    return(print('If the method is rarefaction enter method="rarefaction" or "CR"',quote=F))
  }
  if ((q <= 0 || q >= 1) && method != "rarefaction" && method != "CR")	{
    return(print("If the method is SQS the quota must be greater than zero and less than one",quote=F))
  } else if (q < 1 && (method == "rarefaction" || method == "CR"))	{
    return(print("If the method is rarefaction the quota must be an integer",quote=F))
  }
  if (missing(dominant))	{
    dominant <- 0
  } else if (dominant != "" && dominant != "exclude" && dominant != "no")	{
    return(print('To exclude the dominant taxon, enter dominant="exclude" or "no"',quote=F))
  }
  
  # compute basic statistics
  specimens <- sum(ab)
  singletons <- 0
  doubletons <- 0
  highest <- 0
  for (i in 1:length(ab))	{
    if (ab[i] == 1)	{
      singletons <- singletons + 1
    } else if (ab[i] == 2)	{
      doubletons <- doubletons + 1
    }
    if (ab[i] > highest)	{
      highest <- ab[i]
      mostfrequent <- i
    }
  }
  
  u <- 1 - singletons / specimens
  
  # GTL modification starts
  if (missing(p.1) && dominant == "exclude") {
    u <- 1 - singletons/(specimens - highest)
  }
  if (missing(p.1) && dominant == "no") {
    u <- 1 - singletons/(specimens - highest)
  }
  if (!missing(p.1)) {
    u <- (sum(ab) - p.1)/sum(ab)
  }
  # GTL modification ends
  
  if (u == 0)	{
    return(print("Coverage is zero because all taxa are singletons",quote=F))
  }
  
  # compute raw taxon frequencies (temporarily)
  freq <- ab / specimens
  
  # standard recursive equation for Fishers alpha
  alpha <- 10
  oldalpha <- 0
  while (abs(alpha - oldalpha) > 0.0000001)	{
    oldalpha <- alpha
    alpha <- length(ab) / log(1 + specimens/alpha)
  }
  
  params["raw richness"] <- length(ab)
  params["Good's u"] <- u
  params["subsampled richness"] <- NA
  params["subsampled u"] <- NA
  params["Chao 1"] <- length(ab) + singletons**2/(2* doubletons)
  params["subsampled Chao 1"] <- NA
  # governing parameter of the geometric series distribution
  params["k"] <- abs(lm(log(sort(freq)) ~ c(1:length(freq)))$coefficients[2])
  params["Fisher's alpha"] <- alpha
  params["Shannon's H"] <- -1 * sum(freq * log(freq))
  params["Hurlbert's PIE"] <- (1 - sum(freq**2)) * length(ab) / (length(ab) - 1)
  params["dominance"] <- highest / specimens
  params["specimens"] <- specimens
  params["singletons"] <- singletons
  params["doubletons"] <- doubletons
  params["specimens drawn"] <- 0
  
  if (dominant != "exclude" && dominant != "no")	{
    highest <- 0
    mostfrequent <- 0
  }
  
  # return if the quorum target is higher than overall coverage
  if ((q > u && method != "rarefaction" && method != "CR") || (q >= sum(ab)))	{
    return(params)
  }
  # return if the rarefaction quota is equal to or higher than the
  #  specimen count
  if (method == "rarefaction" && q >= specimens - highest)	{
    return(params)
  }
  
  # compute adjusted taxon frequencies
  freq <- ab * u / (specimens - highest)
  
  # create an array in which each cell corresponds to one specimen
  ids <- array()
  n <- 0
  for (i in 1:length(ab))	{
    for (j in 1:ab[i])	{
      n <- n + 1
      ids[n] <- i
    }
  }
  
  # subsampling trial loop
  # s will be the subsampled taxon count
  s <- array(rep(0,trials))
  subsingle <- array(rep(0,trials))
  subdouble <- array(rep(0,trials))
  subchao <- array(rep(0,trials))
  mostfrequentdrawn <- 0
  for (trial in 1:trials)	{
    pool <- ids
    left <- length(pool)
    seen<- array(data=rep(0,length(ab)))
    subfreq <- array(rep(0,length(ab)))
    if (method != "rarefaction" && method != "CR")	{
      udrawn <- 0
      while (udrawn < q)	{
        # draw a specimen
        x <- floor(runif(1,min=1,max=left+1))
        # add to frequency and taxon sums if species has
        #  not been drawn previously
        subfreq[pool[x]] <- subfreq[pool[x]] + 1
        if (seen[pool[x]] == 0)	{
          if (pool[x] != mostfrequent)	{
            udrawn <- udrawn + freq[pool[x]]
          }
          seen[pool[x]] <- 1
          # randomly throw back some draws that put the sum over q
          #  (improved algorithm added in version 2.0)
          plus <- 1
          if (udrawn > q)	{
            plus <-  1 - q / udrawn
          }
          if (runif(1) <= plus)	{
            s[trial] <- s[trial] + 1
          } else	{
            subfreq[pool[x]] <- subfreq[pool[x]] - 1
          }
        }
        # decrease pool of specimens not yet drawn
        pool[x] <- pool[left]
        left <- left - 1
      }
    } else	{
      i <- 0
      draws <- 0
      while (i < q)	{
        draws <- draws + 1
        x <- floor(runif(1,min=1,max=length(ids)-draws+2))
        subfreq[pool[x]] <- subfreq[pool[x]] + 1
        if (pool[x] != mostfrequent)	{
          i <- i + 1
        }
        if (seen[pool[x]] == 0)	{
          seen[pool[x]] <- 1
          s[trial] <- s[trial] + 1
        }
        pool[x] <- pool[length(ids)-draws+1]
      }
    }
    for (i in 1:length(ab))	{
      if (subfreq[i] == 1 && i != mostfrequent)	{
        subsingle[trial] <- subsingle[trial] + 1
      } else if (subfreq[i] == 2 && i != mostfrequent)	{
        subdouble[trial] <- subdouble[trial] + 1
      }
    }
    if (subsingle[trial] > 0 && subdouble[trial] > 0)	{
      subchao[trial] <- s[trial] + subsingle[trial]**2/(2*subdouble[trial])
    } else	{
      subchao[trial] <- s[trial]
    }
    params["specimens drawn"] <- params["specimens drawn"] + sum(subfreq)
    if (mostfrequent != 0)	{
      mostfrequentdrawn <- mostfrequentdrawn + subfreq[mostfrequent]
    }
  }
  params["specimens drawn"] <- params["specimens drawn"] / trials
  # compute vector of non-zero counts
  options(warn=-1)
  s2 <- sort(sqrt(s-1))^2+1
  options(warn=0)
  # compute geometric mean
  params["subsampled richness"] <- exp(mean(log(s2))) * length(s2)/length(s)
  # use of arithmetic means to compute Goods u is adequate
  mostfrequentdrawn <- mostfrequentdrawn / trials
  params["subsampled u"] <- 1 - mean(subsingle) / (params["specimens drawn"] - mostfrequentdrawn)
  params["subsampled Chao 1"] <- exp(mean(log(subchao)))
  return(params)
  
}

# Quorum level:
q<-0.5

# Global results:
sqs(sort(rle(sort(LC.Global))$lengths, decreasing=TRUE), q=q)["subsampled richness"]
sqs(sort(rle(sort(EM.Global))$lengths, decreasing=TRUE), q=q)["subsampled richness"]
sqs(sort(rle(sort(LM.Global))$lengths, decreasing=TRUE), q=q)["subsampled richness"]

# North American (All) results:
sqs(sort(rle(sort(LC.NA.All))$lengths, decreasing=TRUE), q=q)["subsampled richness"]
sqs(sort(rle(sort(EM.NA.All))$lengths, decreasing=TRUE), q=q)["subsampled richness"]
sqs(sort(rle(sort(LM.NA.All))$lengths, decreasing=TRUE), q=q)["subsampled richness"]

# North American (Ornithischia) results:
sqs(sort(rle(sort(LC.NA.Ornithischia))$lengths, decreasing=TRUE), q=q)["subsampled richness"]
sqs(sort(rle(sort(EM.NA.Ornithischia))$lengths, decreasing=TRUE), q=q)["subsampled richness"]
sqs(sort(rle(sort(LM.NA.Ornithischia))$lengths, decreasing=TRUE), q=q)["subsampled richness"]

# North American (Theropoda) results:
sqs(sort(rle(sort(LC.NA.Theropoda))$lengths, decreasing=TRUE), q=q)["subsampled richness"]
sqs(sort(rle(sort(EM.NA.Theropoda))$lengths, decreasing=TRUE), q=q)["subsampled richness"]
sqs(sort(rle(sort(LM.NA.Theropoda))$lengths, decreasing=TRUE), q=q)["subsampled richness"]